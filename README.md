# Continuous deployment to amazon ecs with bitbucket pipeline

First you have to create a user in AWS IAM. For this user you can create the access key and the secret key.

Next you have to define following environment variables in the Bitbucket Pipeline settings:

- AWS\_DEFAULT\_REGION
- AWS\_ACCESS\_KEY\_ID
- AWS\_SECRET\_ACCESS\_KEY [check &quot;Secured&quot; here]
- AWS\_REGISTRY\_URL

Here is how the general deployment workflow looks like

 ![](data:image/*;base64,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)

**1) Commit code to bitbucket**

Once your commit has been made on the master branch, bitbucket pipelines gets triggered automatically and all the steps illustrated under master branch in the bitbucket-pipelines.yml will get executed. In our case we are using master branch for deployment but it is customizable. The environment variables which we have defined earlier in the bitbucket pipeline settings will be used in this bitbucket-pipelines.yml file.

**2) Test &amp; Build**

Run your test cases to make sure that the code is working before it is being deployed. For this i&#39;ve created a file named &quot;Dockerfile&quot; and included some sample commands for testing and building NodeJS application. You can update the commands accordingly w.r.t the technology that you&#39;re using.

The following command mentioned in bitbucket-pipelines.yml will execute the instructions in the Dockerfile and create a docker image

- docker build -t ${AWS\_REGISTRY\_URL}:$BUILD\_ID .

**3) Push your code to Amazon ECR**

The following command mentioned in bitbucket-pipelines.yml will push the docker image to Amazon ECR

- docker push ${AWS\_REGISTRY\_URL}:$BUILD\_ID

**4) Deploy**

For deployment I wrote the &quot;deploy.sh&quot; script and task-definition.json.

A task definition is required to run Docker containers in Amazon ECS. In task definition you need to specify the following parameters based on your requirement:

- The Docker images to use with the containers in your task
- How much CPU and memory to use with each container
- Working directory of the application (In our case we have placed the files under &quot;app&quot; directory)
- The ports from the container to map to the host container instance

 The &quot;deploy.sh&quot; script will create a new revision of your task definition for you and update your service. You only have to pass following parameters from the bitbucket-pipelines.yml file:

-    name of cluster [-b]
-    the service you want to deploy [-s]
-    the deployment environment (&quot;staging&quot; in our case) [-e]
-    the image name [-i]

   bash ./deploy.sh -b CLUSTER\_NAME -s SERVICE\_NAME -e ${DEPLOYMENT\_ENV} -i $BUILD\_ID



Note: Place all the files in the root directory of your project.
